{% extends "base.html" %}
{% block content %}
<div class="container mt-5">
    <h2>Bedriftsdashboard</h2>
    {% if is_company %}
    <div class="row g-4 align-items-center mb-4">
        <div class="col-md-2 text-center">
            {% if company.logo %}
                <img src="{{ company.logo.url }}" alt="{{ company.company_name }} logo" class="img-fluid rounded shadow-sm" style="max-height: 90px;">
            {% else %}
                <span class="d-inline-block bg-secondary text-white rounded-circle" style="width:90px;height:90px;line-height:90px;font-size:2rem;">üè¢</span>
            {% endif %}
        </div>
        <div class="col-md-7">
            <h4 class="mb-1">{{ company.company_name }}</h4>
            <div><span class="fw-semibold">E-post:</span> {{ company.email }}</div>
            <div><span class="fw-semibold">Adresse:</span> {{ company.address }}</div>
            <div><span class="fw-semibold">Postnummer/sted:</span> {{ company.postal_code }} {{ company.city }}</div>
        </div>
        <div class="col-md-3 d-flex flex-column gap-2">
            <a href="{% url 'giveaways:create' %}" class="btn btn-success w-100" aria-label="Opprett giveaway">‚ûï Opprett giveaway</a>
            <a href="{% url 'accounts:business_profile_edit' %}" class="btn btn-outline-secondary w-100" aria-label="Rediger bedriftsprofil">Rediger bedriftsprofil</a>
            <a href="#giveaways-section" class="btn btn-outline-primary w-100" aria-label="Oversikt over dine giveaways">üì¶ Dine giveaways</a>
            <a href="#log-section" class="btn btn-outline-info w-100" aria-label="Logghistorikk">üìù Logghistorikk</a>
            <a href="{% url 'accounts:logout' %}" class="btn btn-danger w-100 mt-2" aria-label="Logg ut">Logg ut</a>
        </div>
    </div>
    {% if business %}
    <div id="giveaways-section" class="row g-4">
        <div class="col-12 col-lg-6">
            <div class="card h-100">
                <div class="card-header bg-success text-white">Aktive giveaways</div>
                <ul class="list-group list-group-flush">
                    {% for g in giveaways_active %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{ g.title }}</span>
                            <span class="badge bg-success">Aktiv</span>
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen aktive giveaways</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-12 col-lg-6">
            <div class="card h-100">
                <div class="card-header bg-secondary text-white">Avsluttede giveaways</div>
                <ul class="list-group list-group-flush">
                    {% for g in giveaways_ended %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{ g.title }}</span>
                            <span class="badge bg-secondary">Avsluttet</span>
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen avsluttede giveaways</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-12 col-lg-6">
            <div class="card h-100 mt-4">
                <div class="card-header bg-info text-white">Giveaways med vinner</div>
                <ul class="list-group list-group-flush">
                    {% for g in giveaways_with_winner %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{ g.title }}</span>
                            <span class="badge bg-info">Vinner trukket</span>
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen giveaways med vinner</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-12 mt-4" id="log-section">
            <div class="card h-100">
                <div class="card-header bg-light">Logghistorikk</div>
                <ul class="list-group list-group-flush">
                    {% for g in giveaways_log %}
                        <li class="list-group-item">
                            {{ g.title }} - Opprettet: {{ g.created_at|date:"d.m.Y H:i" }}
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen logghistorikk</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    {% endif %}
                    {% for g in giveaways_with_winner %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <span>{{ g.title }}</span>
                            <span class="badge bg-info">Vinner trukket</span>
                        </li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen giveaways med vinner</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="col-12 col-lg-6">
            <div class="card h-100 mt-4">
                <div class="card-header bg-light">Logg (alle giveaways)</div>
                <ul class="list-group list-group-flush">
                    {% for g in giveaways_log %}
                        <li class="list-group-item">{{ g.title }} - {{ g.created_at|date:"d.m.Y H:i" }}</li>
                    {% empty %}
                        <li class="list-group-item text-muted">Ingen giveaways logget</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    {% else %}
    <div class="alert alert-warning mt-4">Dette dashbordet er kun for bedrifter.</div>
    {% endif %}
</div>
{% endblock %}
